---
title: "Flavor matching whisky"
author: "Chase"
date: '2022-02-20'
slug: flavor-matching-whisky
categories: R
tags: lsa
---



<p>Under construction…</p>
<p>Can we identify whiskies with similar flavor profiles based on professional reviews?</p>
<div id="source-data" class="section level1">
<h1>Source data</h1>
<p>Data from <a href="https://www.klwines.com/Products?&amp;filters=sv2_206!27&amp;limit=50&amp;offset=0&amp;orderBy=60%20asc,search.score()%20desc&amp;searchText=">KL Wines</a>.</p>
<div id="import-and-clean" class="section level2">
<h2>Import and clean</h2>
<p>Import the csv and concatenate reviews and descriptions into “bags of words”</p>
<pre class="r"><code>malts &lt;- read_csv(&quot;C:/malts/malts_clean.csv&quot;)
malts_c &lt;- malts %&gt;% 
           unite(&quot;text&quot;, desc, reviews)
write_csv(malts_c, &quot;C:/malts/malts_c.csv&quot;)</code></pre>
<p>Create directory with each product as own file for textmatrix(function).</p>
<pre class="r"><code>malts_c &lt;- read_csv(&quot;C:/malts/malts_c.csv&quot;)
malts_l &lt;- list()
for(i in 1:length(malts_c$name)){
  malts_l[[i]] &lt;- malts_c[i, ]
}
malts_id &lt;- malts_c$id
malts_filenames &lt;- paste0(&quot;C:/malts/malts_d/&quot;, malts_id, &quot;.csv&quot;)

unlist_write &lt;- function(x){
  unlist(x)
}
invisible(
  lapply(seq_along(malts_l), function(x){
    write_csv(malts_l[[x]], malts_filenames[x])
}))</code></pre>
<p>#Analysis using quanteda and quanteda.textmodels</p>
<p>Methodology inspiration from <a href="https://quanteda.io/articles/pkgdown/examples/lsa.html">Wang, H.,</a>.</p>
<pre class="r"><code># malt_dfm &lt;- dfm(malts_c[ ,&quot;text&quot;])
# malt_lsa &lt;- textmodel_lsa(malt_dfm)
# str(malt_lsa)</code></pre>
</div>
</div>
<div id="analysis-using-lsa-and-lsafun" class="section level1">
<h1>Analysis using lsa and LSAfun</h1>
<p>Methodology inspiration from <a href="https://www.researchgate.net/profile/Kai-Larsen/publication/321804167_A_Guide_to_Text_Analysis_with_Latent_Semantic_Analysis_in_R_with_Annotated_Code_Studying_Online_Reviews_and_the_Stack_Exchange_Community/links/5a38c46ca6fdccdd41fe6e7b/A-Guide-to-Text-Analysis-with-Latent-Semantic-Analysis-in-R-with-Annotated-Code-Studying-Online-Reviews-and-the-Stack-Exchange-Community.pdf?origin=publication_detail">Gefen, D. et al, 2017</a>.</p>
<div id="creating-the-input-matrix" class="section level2">
<h2>Creating the input matrix</h2>
<p>The lsa functions need weighted TDMs, so we create them from the imported csv. However, textmatrix() expects a directory full of documents so I need to go back and export each individual product as it’s own file.</p>
<pre class="r"><code>TDM &lt;- textmatrix(&quot;C:/malts/malts_c.csv&quot;, 
                  stopwords=c(stopwords_en, &quot;whisky&quot;, &quot;whiskey&quot;, &quot;single&quot;, &quot;malt&quot;), 
                  stemming=TRUE,
removeNumber=F) 
head(TDM)</code></pre>
<pre><code>##            docs
## terms       malts_c.csv
##   _a                  3
##   _aberlour           1
##   _ahhh               1
##   _all                1
##   _anoth              1
##   _appl               1</code></pre>
</div>
</div>
